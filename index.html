<html>
<head>
	<title>MCEdit Fork</title>
	<script src="js/jquery.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/scripts.js"></script>

	<script src="js/marked.js"></script>

	<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/font-awesome.min.css">
	<link rel="stylesheet" href="css/stylesheet.css">

	<script>
		function pageTrigger() {
			var releaseList = getJSON('https://api.github.com/repos/Khroki/MCEdit-Unified/releases');
			releaseData.sort(compareVersionObject);
			for (var i = 0; i < releaseData.length; i++) {
				var note = marked(releaseData[i].body).replace(/@([a-zA-Z0-9]+)/g,' <a href="http://github.com/$1">@$1</a>');
				var version = releaseData[i].tag_name;
				var title = releaseData[i].name
				if (releaseData[i].prerelease) {
					var releaselabel = 'Pre-release';
				} else {
					var releaselabel = '';
				}
				var releasetimesec = (new Date() - new Date(releaseData[i].published_at)) / 1000;
				var releasetime = new Date(releaseData[i].published_at).toLocaleDateString();
				if (releasetimesec < 60) {
					releasetime = Math.round(releasetimesec) + 's ago';
				} else if (releasetimesec < 60 * 60) {
					releasetime = Math.round(releasetimesec / 60) + 'm ago';
				} else if (releasetimesec < 60 * 60 * 24) {
					releasetime = Math.round(releasetimesec / 60 / 60) + ' hours ago';
				} else if (releasetimesec < 60 * 60 * 24 * 30) {
					releasetime = Math.round(releasetimesec / 60 / 60 / 24) + ' days ago';
				}

				var totalDownloads = 0
				for (var x = releaseData[i].assets.length - 1; x >= 0; x--) {
					totalDownloads += releaseData[i].assets[x].download_count;
				}

				$('#changelog').append('<div class="row releasenote" version="' + version + '"></div>' + (i < releaseData.length - 1 ? '<hr>' : ''));
				releasenote = $('.releasenote[version="' + version + '"]');
				releasenote.append('<div class="col-md-2" style="text-align:right;"><div style="padding-right:10px;"><h2 style="display:inline;"><a href="' + releaseData[i].html_url + '">' + version + '</a></h2><br>' + totalDownloads + ' downloads<br>' + (releaseData[i].prerelease ? 'Pre-release<br>' : '') + releasetime + '</div></div>');
				releasenote.append('<div class="col-md-10"><p>' + note + '</p></div></div>');
			}
			$('#changelog').show();


			var latestRelease = releaseData[0];
			for (var i = 0; i < platforms.length; i++) {
				var asset32 = getDownload(platforms[i],latestRelease.tag_name,32);
				var asset64 = getDownload(platforms[i],latestRelease.tag_name,64);
				if (asset32) {
					$('#' + platforms[i] + '-downloads').append('<a class="dl btn btn-default" href="' + asset32.browser_download_url + '"><i class="fa fa-cloud-download" ></i> Version ' + latestRelease.tag_name + ' 32bit</a><br><br>');
				}
				if (asset64) {
					$('#' + platforms[i] + '-downloads').append('<a class="dl btn btn-default" href="' + asset64.browser_download_url + '"><i class="fa fa-cloud-download"></i> Version ' + latestRelease.tag_name + ' 64bit</a>');
				}
			}
		}
	</script>
</head>
<body>
	<div class="container">
		<div class="row">
			<div class="col-md-12" style="padding:0xp;">
				<div class="jumbotron" style="height:320px;text-align:center;" id="downloads">
					<div class="row">
						<div class="col-md-3 col-md-offset-3">
							<i class="fa fa-apple fa-5x"></i>
							<br><br>Mac OS X<br><br>
							<span id="OSX-downloads">

							</span>
						</div>
						<div class="col-md-3">
							<i class="fa fa-windows fa-5x"></i>
							<br><br>Windows<br><br>
							<span id="Win-downloads">

							</span>
						</div>
					</div>
					<div class="row" style="position:absolute;bottom:40px;">
						<div class="col-md-12">
							<i class="fa fa-linux"></i> Linux requires <a href="http://github.com/Khroki/MCEdit-Unified/releases">running from source.</a>
						</div>
					</div>
				</div>
			</div>
			<div id="changelog" style="display:none;">
			</div>
		</div>
	</body>
	</html>
